{% extends "index.html" %}

{% block title %}Company Profile{% endblock %}

{% block content %}
<div class="container-fluid py-3">

  <div class="d-flex flex-wrap gap-2 align-items-center justify-content-between mb-3">
    <div class="min-w-0">
      <h1 class="h4 mb-0 text-truncate">{{ profile.name_for_display }}</h1>
      <div class="text-muted small">
        Slug: {{ profile.slug }}
        {% if profile.is_active %}
          <span class="badge text-bg-success ms-2">Active</span>
        {% else %}
          <span class="badge text-bg-secondary ms-2">Inactive</span>
        {% endif %}
      </div>
    </div>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-secondary" href="{% url 'money:companyprofile_update' profile.pk %}">
        <i class="fa-solid fa-pen-to-square me-1"></i> Edit
      </a>
      <a class="btn btn-outline-danger" href="{% url 'money:companyprofile_delete' profile.pk %}">
        <i class="fa-solid fa-trash me-1"></i> Delete
      </a>
      {% if not profile.is_active %}
        <form method="post" action="{% url 'money:companyprofile_activate' profile.pk %}">
          {% csrf_token %}
          <button class="btn btn-success" type="submit">
            <i class="fa-solid fa-bolt me-1"></i> Activate
          </button>
        </form>
      {% endif %}
    </div>
  </div>

  <div class="row g-3">
    <div class="col-12 col-lg-4">
      <div class="card shadow-sm">
        <div class="card-body">


          {% if profile.logo %}
            <div class="mb-2">
              <img src="{{ profile.logo.url }}" alt="{{ profile.logo_alt_text|default:profile.name_for_display }}"
                   class="img-fluid rounded" style="max-height:120px;">
            </div>
          {% endif %}

          <div class="small text-muted">Legal name</div>
          <div class="mb-2">{{ profile.legal_name }}</div>

          {% if profile.display_name %}
            <div class="small text-muted">Display name</div>
            <div class="mb-2">{{ profile.display_name }}</div>
          {% endif %}

          {% if profile.website %}
            <div class="small text-muted">Website</div>
            <div class="mb-2"><a href="{{ profile.website }}" target="_blank" rel="noopener">{{ profile.website }}</a></div>
          {% endif %}

          <div class="small text-muted">Primary / Secondary colors</div>
          <div class="d-flex gap-2 align-items-center">
            <code>{{ profile.brand_color_primary|default:"—" }}</code>
            <code>{{ profile.brand_color_secondary|default:"—" }}</code>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 col-lg-8">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="fw-semibold mb-2">Address & Contact</div>

          <div class="mb-3">
            {% for line in profile.full_address_lines %}
              <div>{{ line }}</div>
            {% endfor %}
          </div>

          <div class="row g-3">
            <div class="col-12 col-md-6">
              <div class="small text-muted">Main phone</div>
              <div>{{ profile.main_phone|default:"—" }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Support email</div>
              <div>{{ profile.support_email|default:"—" }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Invoice reply-to</div>
              <div>{{ profile.invoice_reply_to_email|default:"—" }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Tax ID / EIN</div>
              <div>{{ profile.tax_id_ein|default:"—" }}</div>
            </div>
          </div>

          <hr class="my-4">

          <div class="fw-semibold mb-2">Invoice & PDF Defaults</div>

          <div class="row g-3">
            <div class="col-12 col-md-6">
              <div class="small text-muted">Terms</div>
              <div>{{ profile.default_terms|default:"—" }} ({{ profile.default_net_days }} days)</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">PDF Header Layout</div>
              <div>{{ profile.get_pdf_header_layout_display }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Header logo max width</div>
              <div>{{ profile.header_logo_max_width_px }} px</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Vehicle expense method</div>
              <div>{{ profile.get_vehicle_expense_method_display }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Currency / Locale</div>
              <div>{{ profile.default_currency }} / {{ profile.default_locale }}</div>
            </div>
            <div class="col-12 col-md-6">
              <div class="small text-muted">Timezone</div>
              <div>{{ profile.timezone }}</div>
            </div>
          </div>

          {% if profile.default_footer_text %}
            <hr class="my-4">
            <div class="fw-semibold mb-2">Footer</div>
            <div class="text-muted" style="white-space: pre-wrap;">{{ profile.default_footer_text }}</div>
          {% endif %}

        </div>
      </div>
    </div>
  </div>

  <div class="mt-3">
    <a class="btn btn-link px-0" href="{% url 'money:companyprofile_list' %}">&larr; Back to list</a>
  </div>

</div>
{% endblock %}
