{% extends 'index.html' %}

{% block content %}
<div class="container mt-5" style="max-width: 500px;">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">Mileage Rate</h3>
        <a href="{% url 'money:mileage_log' %}?year={{ selected_year }}"
           class="btn btn-outline-secondary btn-sm">
            ‚Üê Back to Mileage Log
        </a>
    </div>

    <!-- Year selector (GET) -->
    <form method="get" class="mb-4">
        <label for="year" class="form-label">Tax Year</label>
        <select
            name="year"
            id="year"
            class="form-select"
            onchange="this.form.submit();"
        >
            {% for y in year_choices %}
                <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>
                    {{ y }}
                </option>
            {% endfor %}
        </select>
    </form>

    <!-- Rate editor (POST) -->
    <form method="post">
        {% csrf_token %}
        <input type="hidden" name="year" value="{{ selected_year }}">

        <div class="mb-3">
            <label for="id_rate" class="form-label">
                Mileage Rate (USD per mile)
            </label>
            {{ form.rate }}
            <div class="form-text">
                Example: 0.6700
            </div>
        </div>

        <button type="submit" class="btn btn-primary w-100">
            Save Rate
        </button>
    </form>
</div>
{% endblock %}
