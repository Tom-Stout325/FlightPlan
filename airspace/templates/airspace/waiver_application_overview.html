{% extends "index.html" %}

{% block title %}Airspace Authorization: {{ planning.operation_title }}{% endblock %}

{% block content %}
<div class="container my-4 my-md-5" style="max-width: 1100px;">
  <form method="post">
    {% csrf_token %}

    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="h5 mb-0">
        Airspace Authorization: {{ planning.operation_title }}
      </h1>
    </div>

    <!-- Responsible Party -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-white border-bottom-0 pb-0">
        <p class="text-uppercase text-muted small mb-1">Responsible Party</p>
      </div>
      <div class="card-body pt-2">
        <div class="row g-3">
          <div class="col-12 col-md-4">
            <div class="small text-muted">Name</div>
            <div class="fw-semibold">
              {{ request.user.first_name }} {{ request.user.last_name }}
            </div>
          </div>
          <div class="col-12 col-md-4">
            <div class="small text-muted">Primary Email</div>
            <div class="fw-semibold">{{ request.user.email }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Operation Parameters -->
    <div class="card mb-4 shadow-sm">
      <div class="card-header bg-white border-bottom-0 pb-0">
        <p class="text-uppercase text-muted small mb-1">Operation Parameters</p>
        <p class="mb-2 fw-semibold">{{ planning.operation_title }}</p>
      </div>
      <div class="card-body pt-2">

        <div class="row g-3 mb-3">
          <div class="col-6 col-md-3">
            <div class="small text-muted">Start Date</div>
            <div class="fw-semibold">
              {{ planning.start_date|date:"m/d/Y" }}
            </div>
          </div>
          <div class="col-6 col-md-3">
            <div class="small text-muted">End Date</div>
            <div class="fw-semibold">
              {% if planning.end_date %}
                {{ planning.end_date|date:"m/d/Y" }}
              {% else %}
                {{ planning.start_date|date:"m/d/Y" }}
              {% endif %}
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="small text-muted">Timeframe</div>
            <div class="fw-semibold">
              {% for label in timeframe_labels %}
                {{ label }}{% if not forloop.last %}<br>{% endif %}
              {% empty %}
                &mdash;
              {% endfor %}
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="small text-muted">Frequency</div>
            <div class="fw-semibold">
              {{ planning.get_frequency_display|default:"—" }}
            </div>
          </div>
        </div>

        <div class="row g-3 mb-3">
          <div class="col-12 col-md-6">
            <div class="small text-muted">Local Time Zone</div>
            <div class="fw-semibold">
              {{ planning.local_time_zone|default:"—" }}
            </div>
          </div>
          <div class="col-12 col-md-3">
            <div class="small text-muted">Proposed Maximum Flight Altitude Above Ground Level (AGL)</div>
            <div class="fw-semibold">
              {% if planning.proposed_agl %}
                {{ planning.proposed_agl }} ft.
              {% else %}
                —
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Proposed Location of Operation -->
        <div class="mb-3">
          <div class="small text-muted">Proposed Location of Operation</div>
          <div class="fw-semibold">
            {{ planning.venue_name|default:"" }}<br>
            {{ planning.street_address|default:"" }}<br>
            {{ planning.location_city|default:"" }},
            {{ planning.location_state|default:"" }}
            {{ planning.zip_code|default:"" }}
          </div>
          {% if planning.location_latitude and planning.location_longitude %}
            <div class="small mt-1 text-muted">
              Coordinates:
              {{ planning.location_latitude }}&deg;,
              {{ planning.location_longitude }}&deg;
            </div>
          {% endif %}
        </div>

        <h6 class="text-muted mb-2">Centerpoint Coordinates (DMS)</h6>

<div class="row g-3 mb-3">
  <div class="col-12 col-md-6">
    <label class="form-label fw-semibold">Latitude</label>
    {% if lat_dms %}
      <div class="row g-2">
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lat_dms.deg }}" readonly>
          <small class="text-muted">Degrees</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lat_dms.min }}" readonly>
          <small class="text-muted">Minutes</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lat_dms.sec }}" readonly>
          <small class="text-muted">Seconds</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lat_dms.dir }}" readonly>
          <small class="text-muted">Direction</small>
        </div>
      </div>
    {% else %}
      <p class="text-muted small mb-0">Not provided.</p>
    {% endif %}
  </div>

  <div class="col-12 col-md-6">
    <label class="form-label fw-semibold">Longitude</label>
    {% if lon_dms %}
      <div class="row g-2">
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lon_dms.deg }}" readonly>
          <small class="text-muted">Degrees</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lon_dms.min }}" readonly>
          <small class="text-muted">Minutes</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lon_dms.sec }}" readonly>
          <small class="text-muted">Seconds</small>
        </div>
        <div class="col-3">
          <input type="text" class="form-control" value="{{ lon_dms.dir }}" readonly>
          <small class="text-muted">Direction</small>
        </div>
      </div>
    {% else %}
      <p class="text-muted small mb-0">Not provided.</p>
    {% endif %}
  </div>
</div>


<div class="d-flex justify-content-between mt-2">
  <!-- Edit planning entry -->
  <a href="{% url 'airspace:waiver_planning_new' %}?planning_id={{ planning.id }}"
     class="btn btn-outline-secondary btn-sm">
    Edit
  </a>

  <!-- Delete planning entry -->
  <a href="{% url 'airspace:waiver_planning_delete' pk=planning.id %}"
     class="btn btn-outline-danger btn-sm">
    Delete Waiver
  </a>

  <!-- Go to Waiver Application overview for this planning entry -->
  <!-- Go to Waiver Application Description / Generator -->
  <a href="{% url 'airspace:waiver_application_description' pk=application.id %}"
     class="btn btn-primary btn-sm">
    Waiver Form
  </a>

</div>


  </form>
</div>
{% endblock %}
